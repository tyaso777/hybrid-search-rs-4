# Tasks

## Done
- [x] Initした時にModelとIndexは並列に読み込む
- [x] Insert画面、Doc Hintは不要。Text, Insert Textは横並びにして、
      Choose File, [File path], Ingest File　という並びの下においてほしい。
- [x] pdfiumのdll格納がきどはぶでは消えている件
- [x] $env:CARGO_BUILD_JOBS = "1", cargo build　によるbuild
- [x] onnxのモデル作成方法が違っていたのでリードミーを修正する。サイト引用すれば良さそう
- [x] SearchタブとFilesタブの表に横スクロールを入れたい。
- [x] 表示はテキスト長すぎ。テキスト列は縦幅を少し増やし、横幅は制限する。
      => 縦幅は調整困難。横の列項目の並びと長さ、表示・非表示を工夫する。
- [x] ファイルを開くボタンがほしい
- [x] chunking-storeにはFileRecordのDBも用意することになる気がする。
- [x] ※SQLiteDB, HNSW Dir, Tantivy Dirは全部別に指定するのではなく、フォルダ指定するようにする。
- [x] Model ONNXのパスはbuild時のパスになる。設定ファイルを参照する方式に変更したい。
- [x] GUI機能として、格納したファイルの一覧が出ると便利である。
- [x] 「モデルをメモリに先読み」は効果が無さそう。EXEを立ち上げた段階で立ち上がり、このアプリは常駐、みたいな運用が楽かも。DBだけ適宜変更する感じ。
- [x] コンフィグ、モデル設定やチャンクパラム、ストアルートを読み取るようにしたい。
- [x] Search結果については前後のテキストも表示してほしい
- [x] テキスト検索結果詳細テキストは前後１つずつ、計2チャンクくっつけた上で、チャンク分割部分で薄い点線入れて切れ目も明確にしつつ、メインテキストがどれだかわかるようにすると良さそう。
- [x] ファイルのメタデータを読み取り、設定する。

## File‑Chunk 
- [ ] チャンク結果が良いかのテストを作成する。「第1章と第1項が同じチャンクに入っているか」などをテストするのでどうか。
- [ ] PowerPoint読み込み機能。
- [ ] RAGでよく言われるような「チャンク（ベクトル検索結果）にその前後の数百文字を追加してLLMに渡す」という処理もだいぶ雑で、文章構造を抽出しておき、おなじ段落内のテキストを必要十分量返す仕組みがほしい。
- [ ] PDF, 右上のタイトルとか第3章、みたいなやつがテキストに残る。まあ修正しなくても良いかも。
- [ ] Word読み込み機能。
  - [x] 見出し1, 2あたりではチャンクが区切られるようにする。ただし、見出し1を使わず見出し2、3をつかったり、見出し1を文章タイトルとして使うケースにも対応する。また、見出し1, 2が（空行を無視して）連続する場合には見出し1, 2間はチャンクを区切らないようにする。
  - [x] 第1章、みたいな表示が消える。見えるようにしたい。
  - [ ] 表についてタブ区切りで表として解釈可能にしたい


  - [ ] h1区切りでチャンクを分割するようにしたいが、うまく動いていない。⇒テストファイルが見出し2で設定しているからダメなのかも。
- [ ] Excel読み込み機能。
  - [x] Excel、シートが変わったらチャンクも変わるように実装してほしい
  - [ ] Excel、セル内改行は改行を消すオプションがほしい。でも性能の良いLLMなら空気を読んでうまく表にできるようだ。
## Store 
- [ ] 正規化と、BM25向けのストップワードの除去（名詞に絞る？）
- [ ] 同じファイルをインジェストするのをチェック+ブロックする機能も欲しい。
## Service 
- [ ] DBとIndex間で整合性をきちんととる。どうやって実装するんだ…？？Add, Delete。FileTableとも整合を取る。うまくできているのか？
## GUI
- [ ] 検索にひづけでの絞り込み入れたい。ソートも欲しい。
- [ ] ログ出力機能が欲しい
- [ ] Files一括入力ボタンがほしい。ファイルパス＋エンコーディングとかで良いのかな？
  - [ ] 既存ファイルと被っていないかざっとチェックする機能も欲しい。⇒ファイル名比較、最初のチャンクでエンベディングしてファイル検索（？）
  - [ ] 事前にプレビュー生成
- [ ] 自分のストアルート集は自分のファイルとして保存したいね。=> 怒られそう => ファイルとして保存できたら良さそう。
- [ ] 1回目の検索が遅い。Vector検索の初期化がうまくいっていない。
## Docs
## refactor
- [ ] chunk_file_with_file_record(...)、chunk_file_with_file_record_with_encoding(...)、chunk_file_with_file_record_with_params(...)があるらしい。3つも本当に必要ですか？
## Others
- [ ] プロンプト調整機能欲しい。GUI側で作る？別フォルダで作成？
- [ ] FTSはプロジェクトから完全にけしたい。




